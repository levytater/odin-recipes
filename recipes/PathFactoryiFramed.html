<!DOCTYPE html>
<head>
    
    
    <meta charset="UTF-9">  
    <title>PathFactory</title>

    
</head>

<body>

    
    <div class "nav">
        <a href = "../index.html">Home</a> <a href = "/recipes/lasagna.html"> Another Nav Link</a> <a href= "/recipes/pizza.html"> And another</a>
    </div>
    
    
        <h1> Links 1 and 2 (to PathFactory) will get decorated with query parameters dynamically, link 3 WILL NOT</h1>
    <ul>
        <li> <a href="https://levshq.lookbookhq.com/c-level/top-policy-trends-2018"> Check out some great content (href link) </a> </li>
	<li> <a href="https://levshq.lookbookhq.com/c-level/the-global-reaction-"> Another link to PF </a> </li>
	<li> <a href="https://google.ca"> A link to Google (NOT to PathFactory)</a> </li>
    </ul>
	
<script>
  (function() {
    var domainsToDecorate = [
            'https://levshq.lookbookhq.com' //add or remove your PathFactory root domain (without https or trailing slash)
        ],
        queryParams = [
            'utm_medium', //add or remove query parameters you want to transfer
            'utm_source',
            'utm_campaign'
        ]
    // do not edit anything below this line
    var links = document.querySelectorAll('a');
  
  // check if links contain domain from the domainsToDecorate array and then decorates
    for (var linkIndex = 0; linkIndex < links.length; linkIndex++) {
        for (var domainIndex = 0; domainIndex < domainsToDecorate.length; domainIndex++) {
            if (links[linkIndex].href.indexOf(domainsToDecorate[domainIndex]) > -1 && links[linkIndex].href.indexOf("#") === -1) {
                links[linkIndex].href = decorateUrl(links[linkIndex].href);
            }
        }
    }
  // decorates the URL with query params
    function decorateUrl(urlToDecorate) {
        urlToDecorate = (urlToDecorate.indexOf('?') === -1) ? urlToDecorate + '?' : urlToDecorate + '&';
        var collectedQueryParams = [];
        for (var queryIndex = 0; queryIndex < queryParams.length; queryIndex++) {
            if (getQueryParam(queryParams[queryIndex])) {
                collectedQueryParams.push(queryParams[queryIndex] + '=' + getQueryParam(queryParams[queryIndex]))
            }
        }
        return urlToDecorate + collectedQueryParams.join('&');
    }
  
    // borrowed from https://stackoverflow.com/questions/831030/
    // a function that retrieves the value of a query parameter
    function getQueryParam(name) {
        if (name = (new RegExp('[?&]' + encodeURIComponent(name) + '=([^&]*)')).exec(window.location.search))
            return decodeURIComponent(name[1]);
    }
  
  })();
  
  </script>	
</body>
